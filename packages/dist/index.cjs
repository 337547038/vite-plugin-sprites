/**
 * name: vite-plugin-sprites
 * version: 0.2.2
 */
"use strict";var H=Object.create;var x=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var z=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var R=(t,e)=>{for(var n in e)x(t,n,{get:e[n],enumerable:!0})},m=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of k(e))!N.call(t,i)&&i!==n&&x(t,i,{get:()=>e[i],enumerable:!(o=W(e,i))||o.enumerable});return t};var P=(t,e,n)=>(n=t!=null?H(z(t)):{},m(e||!t||!t.__esModule?x(n,"default",{value:t,enumerable:!0}):n,t)),D=t=>m(x({},"__esModule",{value:!0}),t);var q={};R(q,{default:()=>T});module.exports=D(q);var w=P(require("fs"),1),d=P(require("path"),1),$=P(require("images"),1),v=(t,e,n)=>{let o=d.default.join(t,e,n);return d.default.relative(t,o)},I=(t={})=>{let{iconPath:e="/src/assets/icon",root:n="./"}=t,o=d.default.join(n,e);if(!w.default.existsSync(o)){console.log(`icon\u56FE\u7247\u8DEF\u5F84\u4E0D\u5B58\u5728${o}`);return}w.default.readdir(o,(i,g)=>{if(i)throw i;let l=g.filter(a=>(a.endsWith(".jpg")||a.endsWith(".png"))&&a!=="sprites.png"),c=l.length,h=0,r=[];console.log(`\u68C0\u6D4B\u5230${c}\u4E2A\u56FE\u7247\u6587\u4EF6\uFF0C\u5F00\u59CB\u8FDB\u884C\u5408\u5E76~`),l.forEach(a=>{let p=v(n,e,a),f=(0,$.default)(p).size();r.push({path:p,width:f.width,height:f.height}),h++,h===c&&O(r,t)})})},O=(t,e)=>{let{root:n="./",savePath:o=e.iconPath||"/src/assets/icon",width:i=500,spacing:g=5,prefix:l="icon-"}=e;t.sort((s,u)=>s.height<u.height);let c=0,h=0,r=0;t.forEach(s=>{s.width+c+g>i?(h+=r+g,c=0,r=0,s.x=s.x||0):s.x=s.x||c,s.height>r&&(r=s.height),s.y=s.y||h,c+=s.width+g});let a=h+r,p=(0,$.default)(i,a),f=v(n,o,"sprites.png"),y=`[class*="${l}"]:before{content:"";background-image: url(./sprites.png); display:flex;align-items: center}
`;t.forEach(s=>{p.draw((0,$.default)(s.path),s.x,s.y);let u=d.default.basename(s.path),C=u.substring(0,u.indexOf(".")),E=s.x?`-${s.x}px`:0,F=s.y?`-${s.y}px`:0;y+=`.${l+C}:before{background-position: ${E} ${F};width: ${s.width}px;height: ${s.height}px}
`});let S=v(n,o,"sprites.css");w.default.writeFile(`${S}`,y,function(s){if(s)throw s;console.log(`\u6210\u529F\u5199\u5165css\u6587\u4EF6\uFF1A${S}`)}),p.save(f),console.log(`\u6210\u529F\u5408\u5E76\u56FE\u7247\uFF1A${f}`)},b=I;var j=t=>{let e=t||{};return{name:"vitePluginSprites",enforce:"pre",configResolved(n){e.root=n.root},buildStart(){b(e)}}};j.images=b;var T=j;
