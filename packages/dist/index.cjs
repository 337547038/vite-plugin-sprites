/**
 * name: vite-plugin-sprites
 * version: 0.2.1
 */
"use strict";var F=Object.create;var d=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty;var R=(s,n)=>{for(var o in n)d(s,o,{get:n[o],enumerable:!0})},j=(s,n,o,e)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of W(n))!z.call(s,i)&&i!==o&&d(s,i,{get:()=>n[i],enumerable:!(e=H(n,i))||e.enumerable});return s};var P=(s,n,o)=>(o=s!=null?F(k(s)):{},j(n||!s||!s.__esModule?d(o,"default",{value:s,enumerable:!0}):o,s)),D=s=>j(d({},"__esModule",{value:!0}),s);var T={};R(T,{default:()=>O});module.exports=D(T);var u=P(require("fs"),1),x=P(require("path"),1),w=P(require("images"),1),v=(s,n,o)=>{let e=x.default.join(s,n,o);return x.default.relative(s,e)},I=(s={})=>{let{iconPath:n="/src/assets/icon",root:o="./"}=s,e=x.default.join(o,n);if(!u.default.existsSync(e)){console.log(`icon\u56FE\u7247\u8DEF\u5F84\u4E0D\u5B58\u5728${e}`);return}u.default.readdir(e,(i,g)=>{if(i)throw i;let p=g.filter(c=>(c.endsWith(".jpg")||c.endsWith(".png"))&&c!=="sprites.png"),h=p.length,a=0,r=[];console.log(`\u68C0\u6D4B\u5230${h}\u4E2A\u56FE\u7247\u6587\u4EF6\uFF0C\u5F00\u59CB\u8FDB\u884C\u5408\u5E76~`),p.forEach(c=>{let l=v(o,n,c),f=(0,w.default)(l).size();r.push({path:l,width:f.width,height:f.height}),a++,a===h&&N(r,s)})})},N=(s,n)=>{let{root:o="./",savePath:e=n.iconPath||"/src/assets/icon",width:i=500,spacing:g=5,prefix:p="icon-"}=n;s.sort((t,$)=>t.height<$.height);let h=0,a=0,r=0;s.forEach(t=>{t.width+h+g>i?(a+=r+g,h=0,r=0,t.x=t.x||0):t.x=t.x||h,t.height>r&&(r=t.height),t.y=t.y||a,h+=t.width+g});let c=a+r,l=(0,w.default)(i,c),f=v(o,e,"sprites.png"),y=`[class*="${p}"]:before{content:"";background-image: url(./sprites.png); display:flex;align-items: center}
`;s.forEach(t=>{l.draw((0,w.default)(t.path),t.x,t.y);let $=t.path.substring(0,t.path.indexOf(".")),C=t.x?`-${t.x}px`:0,E=t.y?`-${t.y}px`:0;y+=`.${p+$}:before{background-position: ${C} ${E};width: ${t.width}px;height: ${t.height}px}
`});let S=v(o,e,"sprites.css");u.default.writeFile(`${S}`,y,function(t){if(t)throw t;console.log(`\u6210\u529F\u5199\u5165css\u6587\u4EF6\uFF1A${S}`)}),l.save(f),console.log(`\u6210\u529F\u5408\u5E76\u56FE\u7247\uFF1A${f}`)},b=I;var m=s=>{let n=s||{};return{name:"vitePluginSprites",enforce:"pre",configResolved(o){n.root=o.root},buildStart(){b(n)}}};m.images=b;var O=m;
