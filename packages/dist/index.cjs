/**
 * name: vite-plugin-sprites
 * version: 0.3.0
 */
"use strict";var k=Object.create;var x=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var I=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var O=(n,t)=>{for(var o in t)x(n,o,{get:t[o],enumerable:!0})},W=(n,t,o,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of z(t))!N.call(n,i)&&i!==o&&x(n,i,{get:()=>t[i],enumerable:!(s=E(t,i))||s.enumerable});return n};var v=(n,t,o)=>(o=n!=null?k(I(n)):{},W(t||!n||!n.__esModule?x(o,"default",{value:n,enumerable:!0}):o,n)),R=n=>W(x({},"__esModule",{value:!0}),n);var q={};O(q,{default:()=>U});module.exports=R(q);var w=v(require("fs"),1),d=v(require("path"),1),P=v(require("images"),1),b=(n,t,o)=>{let s=d.default.join(n,t,o);return d.default.relative(n,s)},D=(n={})=>{let{iconPath:t,root:o="./"}=n,s=d.default.join(o,t);if(!w.default.existsSync(s)){console.log(`icon\u56FE\u7247\u8DEF\u5F84\u4E0D\u5B58\u5728${s}`);return}w.default.readdir(s,(i,g)=>{if(i)throw i;let l=g.filter(h=>(h.endsWith(".jpg")||h.endsWith(".png"))&&h!=="sprites.png"),r=l.length,c=0,a=[];console.log(`\u68C0\u6D4B\u5230${r}\u4E2A\u56FE\u7247\u6587\u4EF6\uFF0C\u5F00\u59CB\u8FDB\u884C\u5408\u5E76~`),l.forEach(h=>{let p=b(o,t,h),f=(0,P.default)(p).size();a.push({path:p,width:f.width,height:f.height}),c++,c===r&&T(a,n)})})},T=(n,t)=>{let{root:o="./",savePath:s=t.savePath||t.iconPath,width:i=500,spacing:g=5,prefix:l="icon-"}=t;n.sort((e,u)=>e.height<u.height);let r=0,c=0,a=0;n.forEach(e=>{e.width+r+g>i?(c+=a+g,r=0,a=0,e.x=e.x||0):e.x=e.x||r,e.height>a&&(a=e.height),e.y=e.y||c,r+=e.width+g});let h=c+a,p=(0,P.default)(i,h),f=b(o,s,"sprites.png"),y=`[class*="${l}"]:before{content:"";background-image: url(./sprites.png); display:flex;align-items: center}
`;n.forEach(e=>{p.draw((0,P.default)(e.path),e.x,e.y);let u=d.default.basename(e.path),C=u.substring(0,u.indexOf(".")),F=e.x?`-${e.x}px`:0,H=e.y?`-${e.y}px`:0;y+=`.${l+C}:before{background-position: ${F} ${H};width: ${e.width}px;height: ${e.height}px}
`});let m=b(o,s,"sprites.css");w.default.writeFile(`${m}`,y,function(e){if(e)throw e;console.log(`\u6210\u529F\u5199\u5165css\u6587\u4EF6\uFF1A${m}`)}),p.save(f),console.log(`\u6210\u529F\u5408\u5E76\u56FE\u7247\uFF1A${f}`)},$=D;var S=(n,t)=>{n.replace(/\\/g,"/").indexOf(t.iconPath)!==-1&&(n.endsWith(".jpg")||n.endsWith(".png"))&&$(t)},j=n=>{let t=n||{};return t.iconPath||(t.iconPath="/src/assets/icon"),{name:"vitePluginSprites",enforce:"pre",configResolved(o){t.root=o.root},buildStart(){$(t)},handleHotUpdate({file:o,server:s}){},configureServer(o){o.watcher.on("add",s=>{S(s,t)}),o.watcher.on("change",s=>{S(s,t)}),o.watcher.on("unlink",s=>{S(s,t)})}}};j.images=$;var U=j;
